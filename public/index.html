<!DOCTYPE html>
<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
    <title>jQuery Example</title>
    <script>
      $(document).ready(function() {
        $.ajaxSetup({ cache: true });
        $.getScript('https://connect.facebook.net/en_US/sdk.js', function() {
          FB.init({
            appId: '392982790763746',
            xfbml: true,
            version: 'v2.3'
          });
          $('#loginbutton,#feedbutton').removeAttr('disabled');
          // The state of person visiting this page the can be:
          // 1. Logged into your app ('connected')
          // 2. Logged into Facebook, but not your app ('not_authorized')
          // 3. Not logged into Facebook and can't tell if they are logged into your app or not.
          FB.getLoginStatus(statusChangeCallback);
        });
        $('#publish').click(doPublish);
        $('#selectall').click(selectAll);
      });

      // This is called with the results from from FB.getLoginStatus().
      function statusChangeCallback(response) {
        console.log(response);
        $('#status').html("");
        $('#groups').html('');
        if (response.status === 'connected') {
          listGroups();
        } else if (response.status === 'not_authorized') {
          $('#status').html('Please log into this app.');
        } else {
          $('#status').html('Please log into Facebook.');
        }
      };
    
      function listGroups() {
        FB.api('/me/groups?fields=id,name,icon,link,privacy,description&limit=50000',
          function(response) {
            groups = response.data;
            groupsList = $('#groups');
            groups.forEach(function(group) {
              groupsList.append(
                '<li>' +
                  '<input type="checkbox" value="' + group.id + '"/>' +
                  '<img src="' + group.icon + '"/>' +
                  '<a target="_blank" href="https://www.facebook.com/groups/' + group.id + '/">' +
                    group.name +
                  '</a>' +
                '</li>'
              );
            });
          }
        );
      };
      
      function doPublish() {
        ctype = $('[name=ctype]:checked').val();
        message = $('#message').val();
        link = $('#link').val();
        edge = '';
        params = {};
        if (ctype == 'text') {
          params = { 'message': message };
          edge = 'feed';
        } else if (ctype == 'link') {
          params = { 'message': message, 'link': link };
          edge = 'feed';
        } else if (ctype == 'photo') {
          params = { 'message': message, 'url': link };
          edge = 'photos';
        } else if (ctype == 'video') {
          params = {
            'file_url': link,
            'description': message,
            'title': $('#vidtitle').val()
          };
          edge = 'videos';
        } else {
          alert('Choose a post type, idiot!');
          return;
        }
        schedule(edge, params)
      };

      function schedule(edge, params) {
        interval = parseInt($('#interval').val());
        $('#groups li :checked').each(function(index, group) {
          setTimeout(function() {
            FB.api('/' + group.value + '/' + edge,
                'POST',
                params,
                function(response) {
                  if (response && !response.error) {
                    console.log("Success!");
                    console.log(response);
                  } else {
                    console.error("Problem!");
                    console.log(response);
                  }
                }
            );
          }, index * interval * 1000);
        });
      };
      function selectAll() {
        $('#groups li input[type=checkbox]').each(function(index, elem) {
          $(elem).prop('checked', true)
        });
      }
    </script>
    <meta charset="UTF-8">
  </head>
<body>
<div id="fb-root"></div>
<div class="fb-login-button" data-max-rows="1" data-size="xlarge" data-show-faces="false" data-auto-logout-link="true" onlogin="statusChangeCallback();" data-scope="user_groups,publish_actions"></div>
<div id="status">
</div>
<div>
  <ul id="groups">
  </ul>
</div>
<div>
  <br>
  <input type="button" name="selectall" id="selectall" value="Select All"/>
  <br>
</div>
<div>
  <input type="radio" name="ctype" value="text">Text
  <input type="radio" name="ctype" value="link">Link
  <input type="radio" name="ctype" value="photo">Photo
  <input type="radio" name="ctype" value="video">Video<br>
  Status<br>
  <textarea id="message" name="message" rows="10" placeholder="Post, link description, photo caption or video caption"></textarea><br>
  Link / ImageUrl / VideoUrl <input type="text" id="link" name="link" placeholder="https://example.com/whatever"/><br>
  Video Title <input type="text" id="link" name="link" placeholder="Video Title (only when posting a video)"/><br>
  Delay in Seconds <input type="number" id="interval" min="1" max="1000" value="2"/><br>
  <input type="button" id="publish" name="submit" value="Publish!"/><br>
</div>
</body>
</noscript>
<div style="text-align: center;"><div style="position:relative; top:0; margin-right:auto;margin-left:auto; z-index:99999">

</div></div>
</html>
